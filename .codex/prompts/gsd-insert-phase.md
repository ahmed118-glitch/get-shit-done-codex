---
description: Insert urgent work as decimal phase (for example 72.1) between existing phases
argument-hint: <after> <description>
---



## Objective
Insert urgent work as decimal phase (for example 72.1) between existing phases

## Compatibility
- Use .codex/skills/get-shit-done-codex semantics.
- Treat upstream workflow as the source of truth.
- Replace user-specific paths with workspace-relative paths (.claude/..., .planning/...).
- Resolve gsd-tools path (prefer .cjs, fallback to .js):
  $GsdTools = if (Test-Path ".claude/get-shit-done/bin/gsd-tools.cjs") { ".claude/get-shit-done/bin/gsd-tools.cjs" } elseif (Test-Path ".claude/get-shit-done/bin/gsd-tools.js") { ".claude/get-shit-done/bin/gsd-tools.js" } elseif (Test-Path "$HOME/.claude/get-shit-done/bin/gsd-tools.cjs") { "$HOME/.claude/get-shit-done/bin/gsd-tools.cjs" } elseif (Test-Path "$HOME/.claude/get-shit-done/bin/gsd-tools.js") { "$HOME/.claude/get-shit-done/bin/gsd-tools.js" } else { throw "Missing gsd-tools in .claude or $HOME/.claude. Reinstall GSD." }
- Run engine commands through PowerShell:
  node $GsdTools ...
- Parse JSON with ConvertFrom-Json; parse key/value output when workflow uses KEY=value raw mode.
- No jq / bash-only constructs.

## Subagent lifecycle (required)

- Translate each upstream `Task(...)` into `spawn_agent` -> `wait` -> `close_agent`.
- Spawn only when the upstream workflow defines an agent role.
- Use `.claude/agents/gsd-*.md` as role context for each spawned agent.
- Do not advance workflow steps until wait and close complete.
## Update check
- Best-effort only; do not fail if offline.
- Run:
  $installed = if (Test-Path ".codex/gsd/VERSION") { (Get-Content ".codex/gsd/VERSION" -Raw).Trim() } elseif (Test-Path "$HOME/.codex/gsd/VERSION") { (Get-Content "$HOME/.codex/gsd/VERSION" -Raw).Trim() } else { $null }
  $latest = $null; try { $latest = (npm view gsd-codex-cli version).Trim() } catch {}
- If $installed and $latest and $installed -ne $latest, surface:
  "Update available: $installed -> $latest. Next: gsd-update (Codex) / /gsd:update (Claude) or re-run npx gsd-codex-cli@latest."

## Execution
1. Parse <after> <description> from the user input.
2. Run init:
node $GsdTools init phase-op $AFTER --raw

3. Load .claude/get-shit-done/workflows/insert-phase.md and execute it step-by-step.
4. Translate each Task(...) in workflow into:
   - spawn_agent with the matching role file context from .claude/agents/.
   - wait for each spawned agent and apply returned output before moving forward.
5. Preserve all gates and routing from upstream workflow.
6. Preserve commit behavior using 
node $GsdTools commit "message" --files ....
7. If commit preflight fails (no git / no commit flag), proceed in read-only mode and report clearly.

## Completion output
- Summarize key artifacts created/updated.
- Next recommended command: use the next user-facing GSD command (Codex prompt name + Claude slash command).
- Never recommend internal `node ... gsd-tools ...` commands to the user.
